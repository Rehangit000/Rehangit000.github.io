<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Data Processor</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      margin: 40px;
    }
    .container {
      max-width: 500px;
      margin: auto;
      padding: 20px;
      border: 1px solid #ddd;
      border-radius: 8px;
    }
    input, button {
      margin-top: 10px;
      padding: 10px;
      width: 100%;
    }
    #outputLink {
      margin-top: 20px;
      display: none;
    }
  </style>
</head>
<body>
  <div class="container">
    <h2>Upload Data for Processing</h2>

    <!-- Excel Upload -->
    <input type="file" id="excelFile" accept=".xlsx,.xls,.csv">

    <p>OR</p>

    <!-- Google Sheet Link -->
    <input type="text" id="sheetLink" placeholder="Paste Google Sheets link here">

    <!-- Submit Button -->
    <button onclick="sendData()">Process Data</button>

    <!-- Output -->
    <div id="outputLink">
      <p>Your processed file is ready:</p>
      <a id="downloadFile" href="#" target="_blank">Download Here</a>
    </div>
  </div>

  <script>
    async function sendData() {
      const webhookUrl = "PASTE_YOUR_MAKE_WEBHOOK_URL_HERE"; // Change this

      const fileInput = document.getElementById('excelFile').files[0];
      const sheetLink = document.getElementById('sheetLink').value.trim();

      const formData = new FormData();

      if (fileInput) {
        formData.append("file", fileInput);
      }
      if (sheetLink) {
        formData.append("sheetLink", sheetLink);
      }

      try {
        const response = await fetch(webhookUrl, {
          method: "POST",
          body: formData
        });

        if (!response.ok) throw new Error("Server error");

        const data = await response.json();

        // Expecting Make to return: { "downloadUrl": "https://..." }
        if (data.downloadUrl) {
          document.getElementById('outputLink').style.display = 'block';
          document.getElementById('downloadFile').href = data.downloadUrl;
        } else {
          alert("No download link returned. Check your Make scenario.");
        }
      } catch (error) {
        alert("Error: " + error.message);
      }
    }
  </script>
</body>
</html>
